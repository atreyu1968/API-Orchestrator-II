// Definiciones de Prompts optimizados para DeepSeek (V3 y R1)

export const AGENT_MODELS = {
  REASONER: "deepseek-reasoner", // R1: Para pensar
  WRITER: "deepseek-chat",       // V3: Para escribir
  FAST: "deepseek-chat"          // V3: Para resumir/editar
};

export const PROMPTS = {
  
  // 1. GLOBAL ARCHITECT (R1)
  GLOBAL_ARCHITECT: (premise: string, genre: string, chapters: number) => `
    Eres un Arquitecto Narrativo de Best-Sellers.
    OBJETIVO: Crear la estructura maestra para una novela de ${genre} de ${chapters} capítulos.
    PREMISA: "${premise}"

    SALIDA REQUERIDA (JSON Estricto):
    {
      "world_bible": { "characters": [], "rules": [] },
      "plot_threads": [ { "name": "Nombre del hilo", "goal": "Resolución esperada" } ],
      "outline": [
        { "chapter_num": 1, "title": "...", "summary": "Sinopsis de 2 líneas", "key_event": "..." }
      ]
    }
    Piensa paso a paso en la estructura de 3 actos antes de generar el JSON.
  `,

  // 2. CHAPTER ARCHITECT (R1)
  CHAPTER_ARCHITECT: (globalSummary: string, storyState: string) => `
    Eres el Director de Escena.
    OBJETIVO: Desglosar este capítulo en 3-4 escenas escribibles.
    RESUMEN CAPÍTULO: "${globalSummary}"
    ESTADO ACTUAL: ${storyState}

    SALIDA REQUERIDA (JSON):
    {
      "scenes": [
        {
          "scene_num": 1,
          "characters": ["..."],
          "setting": "...",
          "plot_beat": "Acción específica que ocurre",
          "emotional_beat": "Cambio interno del personaje",
          "ending_hook": "Cómo transiciona a la siguiente escena"
        }
      ]
    }
  `,

  // 3. GHOSTWRITER (V3) - Escena por Escena
  GHOSTWRITER_SCENE: (
    scenePlan: string, 
    prevSceneContext: string, 
    rollingSummary: string
  ) => `
    Eres un Novelista Fantasma de élite. Estás escribiendo UNA ESCENA de una novela mayor.
    
    CONTEXTO MEMORIA (Lo que pasó antes):
    ${rollingSummary}

    CONTEXTO INMEDIATO (Últimas líneas escritas, mantén este flujo):
    "${prevSceneContext}"

    PLAN DE ESTA ESCENA:
    ${scenePlan}

    INSTRUCCIONES:
    1. Escribe 1000-1400 palabras.
    2. "Show, don't tell". Usa prosa sensorial.
    3. Si es continuación, NO repitas explicaciones. Sigue la acción.
    4. NO termines el capítulo, solo termina la escena según el plan.
    
    SALIDA: Solo el texto de la narrativa en Markdown.
  `,

  // 4. SMART EDITOR (V3) - Output JSON
  SMART_EDITOR: `
    Eres un Editor Senior. Evalúa el texto proporcionado.
    
    CRITERIOS DOBLE 10:
    1. LÓGICA: ¿Tiene sentido la trama? ¿Hay errores de continuidad?
    2. ESTILO: ¿Es buena la prosa? ¿Ritmo adecuado?

    SI EL SCORE ES > 5 PERO < 9:
    Genera "parches" para corregir errores puntuales sin reescribir todo.

    SALIDA JSON:
    {
      "logic_score": 1-10,
      "style_score": 1-10,
      "is_approved": boolean, (True si ambos scores > 8)
      "feedback": "...",
      "patches": [
        {
          "original_text_snippet": "Texto exacto a buscar (único)",
          "replacement_text": "Texto corregido",
          "reason": "Gramática / Continuidad"
        }
      ]
    }
  `,

  // 5. SUMMARIZER (V3)
  SUMMARIZER: `
    Resume el texto adjunto en 200 palabras.
    Céntrate en: Hechos, objetos obtenidos, heridas, cambios de relación y ubicación.
    Ignora: Prosa poética y diálogos decorativos.
    Salida: Texto plano.
  `,

  // 6. NARRATIVE DIRECTOR (R1) - Cada 5 caps
  NARRATIVE_DIRECTOR: (recentSummaries: string, threads: string) => `
    Eres el Showrunner. Analiza los últimos 5 capítulos.
    HILOS ACTIVOS: ${threads}
    LO QUE PASÓ: ${recentSummaries}

    ¿Se ha estancado la trama? ¿Hay hilos olvidados?
    Genera una directiva de corrección para el próximo bloque de capítulos.
    Ej: "Aumentar ritmo, matar a personaje secundario".
  `
};